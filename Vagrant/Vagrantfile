# -*- mode: ruby -*-
# vi: set ft=ruby :
Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/jammy64"
  config.vm.network "public_network",
    use_dhcp_assigned_default_route: true
  config.vm.synced_folder "./shared/", "/shared"
  config.vm.provision "shell",privileged: false, inline: <<-SHELL
  sudo apt update
  sudo apt upgrade
  sudo apt install -y nginx lynx vim git
  wget https://github.com/stuffbymax/vargant/archive/refs/heads/main.zip
  unzip main.zip
  cd vargant-main
  cp /10.1.0.65 /var/www/
  cd /etc/nginx/sites-available/
  sudo tee /etc/nginx/sites-available/10.1.0.65 > /dev/null <<EOF
server {
        listen 80;
        listen [::]:80;

        root /var/www/10.1.0.65/;
        index index.html index.htm index.nginx-debian.html;

        server_name 10.1.0.65 www.10.1.0.65;

        location / {
                try_files \$uri \$uri/ =404;
        }
}
EOF
sudo ln -sf /etc/nginx/sites-available/10.1.0.65 /etc/nginx/sites-enabled/
sudo systemctl restart nginx
  SHELL
end
